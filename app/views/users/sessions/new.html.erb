
<div class="container">
    <h2 class="header">Log in</h2>
    <div class="card">
        <div class="card-content col">
          <%= form_for(resource, as: resource_name, url: session_path(resource_name), class: "card-content") do |f| %>
            <div class="field">
              <%= f.label :email %><br />
              <%= f.email_field :email, autofocus: true %>
            </div>

            <div class="field">
              <%= f.label :password %><br />
              <%= f.password_field :password, autocomplete: "off" %>
            </div>

            <% if devise_mapping.rememberable? -%>
              <div class="field">
                <%= f.check_box :remember_me %>
                <%= f.label :remember_me %>
              </div>
            <% end -%>

            <div class="actions">
              <%= f.button "Log in", type: "submit", class: "btn waves-effect waves-light" %>
            </div>
          <% end %>

          <%= render "users/shared/links" %>
        </div>
    </div>
</div>

<script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
<style>
    video { border: 1px solid #ccc; display: block; margin: 0 0 20px 0; }
    #canvas { margin-top: 20px; border: 1px solid #ccc; display: block; }
</style>
<div>
  <div><video id="video" width="640" height="480" autoplay></video></div>
  <div><button id="snap">Snap Photo</button></div>
  <div><button id="save">Salvar Foto</button></div>
  <div><canvas id="canvas" width="640" height="480"></canvas></div>

  <script>
      // Put event listeners into place
      window.addEventListener("DOMContentLoaded", function() {
          // Grab elements, create settings, etc.
          var canvas = document.getElementById("canvas"),
                  context = canvas.getContext("2d"),
                  video = document.getElementById("video"),
                  videoObj = { "video": true },
                  errBack = function(error) {
                      console.log("Video capture error: ", error.code);
                  };

          // Put video listeners into place
          if(navigator.getUserMedia) { // Standard
              navigator.getUserMedia(videoObj, function(stream) {
                  video.src = stream;
                  video.play();
              }, errBack);
          } else if(navigator.webkitGetUserMedia) { // WebKit-prefixed
              navigator.webkitGetUserMedia(videoObj, function(stream){
                  video.src = window.webkitURL.createObjectURL(stream);
                  video.play();
              }, errBack);
          }
          else if(navigator.mozGetUserMedia) { // Firefox-prefixed
              navigator.mozGetUserMedia(videoObj, function(stream){
                  video.src = window.URL.createObjectURL(stream);
                  video.play();
              }, errBack);
          }
      }, false);

      document.getElementById("snap").addEventListener("click", function() {
          canvas.getContext("2d").drawImage(video, 0, 0, 640, 480);
          //alert(canvas.toDataURL());
      });
      document.getElementById("save").addEventListener("click", function() {
          $.post('fotossalvar.php', {imagem:canvas.toDataURL()}, function(data){
          },'json');
      });
  </script>
</div>